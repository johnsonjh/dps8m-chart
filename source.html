<!DOCTYPE html>
<!-- Copyright (c) 2025 Jeffrey H. Johnson -->
<!-- SPDX-License-Identifier: MIT -->
<!-- vim: set expandtab ft=javascript: -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- "https://cdn.jsdelivr.net/npm/chart.js@4.4.9/dist/chart.umd.min.js" -->
    <script src="chart.umd.min.js"></script>
    <!-- "https://cdn.jsdelivr.net/npm/choices.js@11.1.0/public/assets/styles/choices.min.css" -->
    <link rel="stylesheet" href="choices.min.css" />
    <!-- "https://cdn.jsdelivr.net/npm/choices.js@11.1.0/public/assets/scripts/choices.min.js" -->
    <script src="choices.min.js"></script>
    <!-- "https://cdn.jsdelivr.net/npm/chartjs-plugin-deferred@2.0.0/dist/chartjs-plugin-deferred.min.js" -->
    <script src="chartjs-plugin-deferred.min.js"></script>
    <title>DPS8M Benchmark Visualizer</title>
    <style>
        .choices {
            background-color: #000000;
            color: #ffffff;
            border: 1px solid #4b5563;
        }
        .choices__inner {
            background-color: #000000;
            color: #ffffff;
            border: 1px solid #4b5563;
            border-radius: 0 !important;
        }
        .choices__input {
            background-color: #000000;
            color: #ffffff;
        }
        .choices__list--dropdown {
            background-color: #1f2935;
            color: #ffffff;
            border: 1px solid #4b5563;
            border-radius: 0 !important;
        }
        .choices__list--dropdown .choices__item,
        .choices__list--dropdown .choices__item--selectable {
            color: #ffffff !important;
        }
        .choices__list--dropdown .choices__item--selectable.is-highlighted {
            background-color: #000000;
            color: #ffffff !important;
        }
        .choices__item {
            background-color: #1f2935;
            color: #ffffff;
        }
        .choices__list--multiple .choices__item {
            border-radius: 0 !important;
            background-color: #4b5563;
            color: #ffffff;
        }
        .choices__item--selectable:hover {
            background-color: #4b5563;
            color: #ffffff;
            border-radius: 0 !important;
        }
        .choices__list[aria-expanded] .choices__item--selectable.is-highlighted {
            background-color: #000000;
        }
        .choices__item--choice.is-selected,
        .choices__item--choice.is-highlighted {
            background-color: #4b5563;
            color: #ffffff;
            border-radius: 0 !important;
        }
        .choices__button {
            background-color: #4b5563;
            color: #ffffff;
            border: none;
            border-radius: 0 !important;
        }
        input[type="radio"] {
            background-color: #374151;
            border: 1px solid #4b5563;
        }
        input[type="radio"]:checked {
            background-color: #4b5563;
            border-color: #ffffff;
        }
        body {
            background-color: #323232;
            padding: 10px;
            font-family: sans-serif;
        }
        .container {
            max-width: 94%;
            margin: 0 auto;
            color: #fff;
            background-color: #444;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .select-container {
            margin-bottom: 16px;
        }
        label {
            display: block;
            font-size: 14px;
            color: #ffffff;
            white-space: nowrap;
            margin-bottom: 4px;
        }
        .chart-wrapper {
            width: 100%;
            height: 100%;
            margin-bottom: 20px;
            position: relative;
        }
        canvas {
            width: 100% !important;
            height: 100% !important;
        }
        .scale-toggle {
            margin-bottom: 24px;
            white-space: nowrap;
            display: inline-flex;
            vertical-align: bottom;
            gap: 3px;
        }
        .chartjs-render-monitor{
            height: 600px !important;
        }
        .sort-btn {
            background: #1f2935;
            color: #fff;
            border: 1px solid #4b5563;
            border-radius: 4px;
            padding: 6px 16px;
            margin-bottom: 16px;
            cursor: pointer;
        }
        .sort-btn:hover {
            background: #374151;
        }
        .sortable-th {
            cursor: pointer;
            position: relative;
            white-space: nowrap;
        }
        .sortable-th:after {
            content: '';
            font-size: 0.5em;
            vertical-align: bottom;
            display: inline;
            margin-left: 0px;
            padding-left: 10px;
        }
        .sortable-th.sorted-asc:after {
            content: 'â–²';
            font-size: 0.55em;
            vertical-align: top;
            display: inline;
            margin-left: 1px;
            padding-left: 0px;
        }
        .sortable-th.sorted-desc:after {
            content: 'â–¼';
            font-size: 0.55em;
            vertical-align: bottom;
            display: inline;
            margin-left: 1px;
            padding-left: 0px;
        }
        .dynamicTable {
            border-collapse: collapse;
            width: 100%;
            margin-top: 24px;
            background: #222;
        }
        .dynamicTable th, .dynamicTable td {
            border: 1px solid #4b5563;
            padding: 5px 10px;
            color: #fff;
            text-align: center;
        }
        .dynamicTable th {
            background: #1f2935;
        }
        .dynamicTable tr:hover td {
            background: #2d3748;
        }
       .color-dot {
            display: inline-block;
            width: 1em;
            height: 1em;
            border-radius: 50%;
            margin-right: 0.5em;
            vertical-align: middle;
            white-space: nowrap;
        }
        .note-dot {
            width: 2em;
            height: 2em;
            margin-left: 1em;
        }
        .system-label {
            white-space: nowrap;
        }
        ul {
            list-style-type: none;
            padding-left: 0.38em;
            margin: 0;
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        main {
            flex: 1 0 auto;
        }
        footer a {
            color: #4f4f4f;
        }
        footer {
            flex-shrink: 0;
            background: #222;
            color: #4f4f4f;
            padding: 1px 2px 2px 2px;
            border-top: 10px solid #323232;
            font-size: 0.6em;
        }
    </style>
</head>
<body>
    <main>
        <div class="container">
            <div class="select-container">
                <label for="systemSelect">&nbsp;Select Systems:</label>
                <select id="systemSelect" multiple> <!-- XXX: Add new system names below -->
                    <optgroup label="DPS8M R3.1.0 [64â€‘bit]">
                        <option value="RPi5B_R310_64">Raspberry Pi 5B / Linux / Clang / PGO</option>
                        <option value="RPi4B_R310_64">Raspberry Pi 4B / Linux / Clang / PGO</option>
                        <option value="RPi3B_R310_64">Raspberry Pi 3B / Linux / Clang 20 / PGO</option>
                        <option value="APU2_R310_64">PC Engines APU2 / Linux / GCC / PGO</option>
                        <option value="CN2840_R310_64">iCâ€‘N2840 / Linux / GCC / PGO</option>
                        <option value="C4205U_R310_64">iCâ€‘4205U / Linux / GCC / PGO</option>
                        <option value="C2405S_R310_64">iCâ€‘2405S / Linux / GCC / PGO</option>
                        <option value="i3_8130U_R310_64">i3â€‘8130U / Linux / GCC / PGO</option>
                        <option value="i7_8700_R310_64">i7â€‘8700 / Linux / GCC / PGO</option>
                        <option value="GHM_R310_64">GHM / Linux (KVM) / GCC / PGO</option>
                        <option value="X2_240E_R310_64">X2â€‘240e / Linux / GCC / PGO</option>
                        <option value="Thinkpad_R310_64">Thinkpad / Linux (KVM) / GCC / PGO</option>
                    </optgroup>
                    <optgroup label="DPS8M R3.1.0 [32â€‘bit]">
                        <option value="RPi3B_R310_32">Raspberry Pi 3B / Linux / GCC 14.3 / PGO</option>
                        <option value="AR750S_R310_32">AR750S / Linux / GCC / PGO, NO_LOCKLESS</option>
                    </optgroup>
                </select>
            </div>
            <div class="select-container">
                <label for="benchmarkSelect">&nbsp;Select Benchmarks:</label>
                <select id="benchmarkSelect" multiple>
                    <option value="MCS">MCS</option>
                    <option value="nqueensx">nqueensx</option>
                    <option value="PI">mbench â€” PI</option>
                    <option value="SR2">mbench â€” SR2</option>
                    <option value="Pfannkuchen">mbench â€” Pfannkuchen</option>
                    <option value="Eratosthenes">mbench â€” Eratosthenes</option>
                    <option value="Serestone">mbench â€” Serestone</option>
                    <option value="Romberg">mbench â€” Romberg</option>
                    <option value="Trapezoid">mbench â€” Trapezoid</option>
                    <option value="Mirestone">mbench â€” Mirestone</option>
                    <option value="CGMIPS">instr_speed â€” Composite Geometric MIPS</option>
                    <option value="T1">instr_speed â€” TEST 1: lda/sta â€‘ even/odd</option>
                    <option value="T2">instr_speed â€” TEST 2: lda/sta â€‘ odd/even</option>
                    <option value="T3">instr_speed â€” TEST 3: lda/lda/ldaâ€¦</option>
                    <option value="T4">instr_speed â€” TEST 4: lda/sta â€‘ even/odd bit29</option>
                    <option value="T5">instr_speed â€” TEST 5: eppbp/spribp â€‘ even/odd</option>
                    <option value="T6">instr_speed â€” TEST 6: eppbp/spribp â€‘ odd/even</option>
                    <option value="T7">instr_speed â€” TEST 7: eppbp/spribp â€‘ even/odd indirect</option>
                    <option value="T8">instr_speed â€” TEST 8: eppbp/spribp â€‘ odd/even indirect</option>
                    <option value="T9">instr_speed â€” TEST 9: eppbp/spribp â€‘ even/odd bit29</option>
                    <option value="T10">instr_speed â€” TEST 10: eppbp/spribp â€‘ even/odd bit29 indirect</option>
                    <option value="T11">instr_speed â€” TEST 11: eppbp/spribp â€‘ odd/even bit29 indirect</option>
                    <option value="T12">instr_speed â€” TEST 12: random mix</option>
                    <option value="T13">instr_speed â€” TEST 13: lda 0,duâ€¦</option>
                    <option value="T14">instr_speed â€” TEST 14: nop 0,duâ€¦</option>
                    <option value="T15">instr_speed â€” TEST 15: lprpbp/sprpbp â€‘ even/odd bit29</option>
                </select>
            </div>
            <table border=0 cellpadding=0>
                <tr>
                    <td style="vertical-align: top;">
                        <label>Scale Type:</label>
                        <div class="scale-toggle">
                            <input type="radio" name="scale" value="linear" checked><small>Linear&nbsp;</small>
                            <input type="radio" name="scale" value="logarithmic"><small>Logarithmic</small>
                        </div>
                    </td>
                    <td style="vertical-align: top;">
                        &nbsp;&nbsp;&nbsp;&nbsp;
                    </td>
                    <td style="vertical-align: top;">
                        <label>Chart Sorting:</label>
                        <button id="sortChartsBtn" class="sort-btn" type="button">Disabled</button>
                    </td>
                </tr>
            </table>
            <hr>
            <div id="tableContainer"></div>
            <br>
            <div id="chartsContainer"></div>
            <div id="notesContainer"></div>
            <div id="instructions" style="margin-bottom: 12px; color: #ffd; background: #222; padding: 8px; border-radius: 4px;">
                <table border=0 cellpadding=3 width=100%>
                    <tr>
                        <td style="vertical-align: middle; text-align: right; white-space: nowrap;">
                            <font size=+6>ðŸ”Ž&nbsp;</font>
                        </td>
                        <td style="vertical-align: middle; text-align: left;">
                            <br>Select one or more systems and benchmarks for comparison.<br>
                            <small>Users on mobile devices should reduce their browser zoomâ€‘level before making a selection.</small>
                            <br><br>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <script>
            Chart.register(ChartDeferred);
            const systemNotes = {
                "RPi5B_R310_64": "<br><ul><li><b>RPi5B_R310_64</b><ul>" +
                                   "<li>Raspberry Pi 5B <small>(ARMv8-A BCM2711, Arm Cortex A72, 1800MHz)</small></li>" +
                                   "<li>DPS8M R3.1.0 <small>(Clang 20, PGO)</small>, 64â€‘bit</li>" +
                                   "<li>64â€‘bit Linux: Raspberry Pi OS 12 <small>(Bookworm)</small></li>" +
                                 "</ul></li></ul><br>",
                "RPi4B_R310_64": "<br><ul><li><b>RPi4B_R310_64</b><ul>" +
                                   "<li>Raspberry Pi 4B <small>(ARMv8-A BCM2712, Arm Cortex A76, 2400MHz)</small></li>" +
                                   "<li>DPS8M R3.1.0 <small>(Clang 20, PGO)</small>, 64â€‘bit</li>" +
                                   "<li>64â€‘bit Linux: Raspberry Pi OS 12 <small>(Bookworm)</small></li>" +
                                 "</ul></li></ul><br>",
            }; // XXX: Add new notes above
            const benchmarks = [
                { name: 'MCS', unit: 'seconds to build MCS', description: 'Time to build MCS (in seconds)' },
                { name: 'nqueensx', unit: 'nqueensx MIPS', description: 'Millions of instructions per second' },
                { name: 'Pfannkuchen',  unit: 'Pfannkuchen IPS',  description: 'Iterations per second' },
                { name: 'Eratosthenes', unit: 'Eratosthenes IPS', description: 'Iterations per second' },
                { name: 'Serestone',    unit: 'Serestone IPS',    description: 'Iterations per second' },
                { name: 'Romberg',      unit: 'Romberg IPS',      description: 'Iterations per second' },
                { name: 'Trapezoid',    unit: 'Trapezoid IPS',    description: 'Iterations per second' },
                { name: 'Mirestone',    unit: 'Mirestone IPS',    description: 'Iterations per second' },
                { name: 'PI',           unit: 'PI calculation seconds',  description: 'Time to complete (in seconds)' },
                { name: 'SR2',          unit: 'SR2 digits calculated', description: 'Digits calculated (in 10 minutes)' },
                { name: 'CGMIPS', unit: 'instr_speed MIPS', description: 'instr_speed â€” Composite Geometric MIPS'},
                { name: 'T1',     unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 1: lda/sta â€‘ even/odd (MIPS)' },
                { name: 'T2',     unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 2: lda/sta â€‘ odd/even (MIPS)' },
                { name: 'T3',     unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 3: lda/lda/ldaâ€¦ (MIPS)' },
                { name: 'T4',     unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 4: lda/sta â€‘ even/odd bit2 (MIPS)' },
                { name: 'T5',     unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 5: eppbp/spribp â€‘ even/odd (MIPS)' },
                { name: 'T6',     unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 6: eppbp/spribp â€‘ odd/even (MIPS)' },
                { name: 'T7',     unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 7: eppbp/spribp â€‘ even/odd indirect (MIPS)' },
                { name: 'T8',     unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 8: eppbp/spribp â€‘ odd/even indirect (MIPS)' },
                { name: 'T9',     unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 9: eppbp/spribp â€‘ even/odd bit29 (MIPS)' },
                { name: 'T10',    unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 10: eppbp/spribp â€‘ even/odd bit29 indirect (MIPS)' },
                { name: 'T11',    unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 11: eppbp/spribp â€‘ odd/even bit29 indirect (MIPS)' },
                { name: 'T12',    unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 12: random mix (MIPS)' },
                { name: 'T13',    unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 13: lda 0,duâ€¦ (MIPS)' },
                { name: 'T14',    unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 14: nop 0,duâ€¦ (MIPS)' },
                { name: 'T15',    unit: 'instr_speed MIPS', description: 'instr_speed â€” TEST 15: lprpbp/sprpbp â€‘ even/odd bit29 (MIPS)' },
            ];
            const unitSubtitles = {
                'seconds to build MCS':   'â†“ Less is better (elapsed seconds) â†“',
                'nqueensx MIPS':          'â†‘ More is better (millions of instructions per second) â†‘',
                'Pfannkuchen IPS':        'â†‘ More is better (iterations per second) â†‘',
                'Eratosthenes IPS':       'â†‘ More is better (iterations per second) â†‘',
                'Serestone IPS':          'â†‘ More is better (iterations per second) â†‘',
                'Romberg IPS':            'â†‘ More is better (iterations per second) â†‘',
                'Trapezoid IPS':          'â†‘ More is better (iterations per second) â†‘',
                'Mirestone IPS':          'â†‘ More is better (iterations per second) â†‘',
                'PI calculation seconds': 'â†“ Less is better (elapsed seconds) â†“',
                'SR2 digits calculated':  'â†‘ More is better (digits calculated in ten minutes) â†‘',
                'instr_speed MIPS':       'â†‘ More is better (millions of instructions per second) â†‘',
            };
            const benchmarkData = {
                RPi5B_R310_64: {
                    nqueensx: 10.84,
                    CGMIPS: 10.24,
                    T1: 10.48,
                    T2: 10.51,
                    T3: 13.21,
                    T4: 10.28,
                    T5: 10.41,
                    T6: 10.37,
                    T7: 7.71,
                    T8: 7.72,
                    T9: 10.15,
                    T10: 7.57,
                    T11: 7.44,
                    T12: 10.76,
                    T13: 15.06,
                    T14: 15.70,
                    T15: 10.26,
                    Pfannkuchen: 25.40,
                    Eratosthenes: 13.37,
                    Serestone: 1069.58,
                    Romberg: 145.84,
                    Trapezoid: 214.86,
                    Mirestone: 30.77,
                    MCS: 58.79,
                    PI: 521.41,
                    SR2: 1325,
                },
                RPi4B_R310_64: {
                    nqueensx: 4.26,
                    CGMIPS: 4.21,
                    T1: 4.31,
                    T2: 4.30,
                    T3: 5.67,
                    T4: 4.24,
                    T5: 4.17,
                    T6: 4.15,
                    T7: 3.14,
                    T8: 3.11,
                    T9: 4.09,
                    T10: 3.09,
                    T11: 3.04,
                    T12: 4.04,
                    T13: 4.07,
                    T14: 6.90,
                    T15: 4.27,
                    Pfannkuchen: 9.69,
                    Eratosthenes: 5.73,
                    Serestone: 393,
                    Romberg: 54.94,
                    Trapezoid: 78.79,
                    Mirestone: 11.40,
                    MCS: 150.09,
                    PI: 1369.78,
                    SR2: 509,
                },
                RPi3B_R310_64: {
                    nqueensx: 1.56,
                    CGMIPS: 1.56,
                    T1: 1.55,
                    T2: 1.55,
                    T3: 1.94,
                    T4: 1.50,
                    T5: 1.61,
                    T6: 1.61,
                    T7: 1.22,
                    T8: 1.22,
                    T9: 1.55,
                    T10: 1.19,
                    T11: 1.16,
                    T12: 1.58,
                    T13: 2.35,
                    T14: 2.42,
                    T15: 1.52,
                    Pfannkuchen: 3.74,
                    Eratosthenes: 2.16,
                    Serestone: 149.89,
                    Romberg: 21.34,
                    Trapezoid: 30.19,
                    Mirestone: 4.51,
                    MCS: 390.64,
                    PI: 3626.1,
                    SR2: 193,
                },
                RPi3B_R310_32: {
                    nqueensx: 1.00,
                    CGMIPS: 0.98,
                    T1: 0.97,
                    T2: 0.97,
                    T3: 1.26,
                    T4: 0.97,
                    T5: 0.98,
                    T6: 0.98,
                    T7: 0.77,
                    T8: 0.77,
                    T9: 0.97,
                    T10: 0.77,
                    T11: 0.76,
                    T12: 1.00,
                    T13: 1.43,
                    T14: 1.49,
                    T15: 0.96,
                    Pfannkuchen: 2.26,
                    Eratosthenes: 1.42,
                    Serestone: 101.81,
                    Romberg: 12.84,
                    Trapezoid: 19.24,
                    Mirestone: 2.78,
                    MCS: 543.56,
                    PI: 5925.9,
                    SR2: 116,
                },
                AR750S_R310_32: {
                    nqueensx: 0.63,
                    CGMIPS: 0.65,
                    T1: 0.57,
                    T2: 0.57,
                    T3: 0.74,
                    T4: 0.65,
                    T5: 0.70,
                    T6: 0.70,
                    T7: 0.55,
                    T8: 0.55,
                    T9: 0.69,
                    T10: 0.54,
                    T11: 0.55,
                    T12: 0.65,
                    T13: 0.86,
                    T14: 0.88,
                    T15: 0.64,
                    Pfannkuchen: 1.31,
                    Eratosthenes: 0.71,
                    Serestone: 54.52,
                    Romberg: 6.47,
                    Trapezoid: 11.05,
                    Mirestone: 1.39,
                    MCS: 1049.57,
                    PI: 10653.01,
                    SR2: 67,
                },
                APU2_R310_64: {
                    nqueensx: 1.97,
                    CGMIPS: 1.98,
                    T1: 2.05,
                    T2: 2.05,
                    T3: 2.37,
                    T4: 2.00,
                    T5: 0.70,
                    T6: 2.09,
                    T7: 2.09,
                    T8: 1.56,
                    T9: 2.08,
                    T10: 1.56,
                    T11: 1.52,
                    T12: 1.80,
                    T13: 2.77,
                    T14: 2.87,
                    T15: 1.94,
                    Pfannkuchen: 4.24,
                    Eratosthenes: 2.38,
                    Serestone: 172.19,
                    Romberg: 24.81,
                    Trapezoid: 37.21,
                    Mirestone: 5.17,
                    MCS: 354.48,
                    PI: 3103.82,
                    SR2: 232,
                },
                CN2840_R310_64: {
                    nqueensx: 3.97,
                    CGMIPS: 4.57,
                    T1: 4.68,
                    T2: 4.64,
                    T3: 5.60,
                    T4: 4.49,
                    T5: 4.75,
                    T6: 4.80,
                    T7: 3.54,
                    T8: 3.56,
                    T9: 4.61,
                    T10: 3.53,
                    T11: 3.52,
                    T12: 4.18,
                    T13: 6.71,
                    T14: 6.99,
                    T15: 4.47,
                    Pfannkuchen: 9.69,
                    Eratosthenes: 5.44,
                    Serestone: 387.4,
                    Romberg: 52.15,
                    Trapezoid: 79.96,
                    Mirestone: 11.31,
                    MCS: 144.93,
                    PI: 1411.17,
                    SR2: 510,
                },
                C4205U_R310_64: {
                    nqueensx: 6.13,
                    CGMIPS: 6.10,
                    T1: 6.10,
                    T2: 6.17,
                    T3: 7.27,
                    T4: 6.00,
                    T5: 6.42,
                    T6: 6.45,
                    T7: 4.78,
                    T8: 4.77,
                    T9: 6.24,
                    T10: 4.73,
                    T11: 4.65,
                    T12: 6.25,
                    T13: 8.56,
                    T14: 9.04,
                    T15: 5.90,
                    Pfannkuchen: 13.96,
                    Eratosthenes: 8.57,
                    Serestone: 593.72,
                    Romberg: 81.77,
                    Trapezoid: 125.49,
                    Mirestone: 17.8,
                    MCS: 101.23,
                    PI: 946.28,
                    SR2: 728
                },
                C2405S_R310_64: {
                    nqueensx: 9.38,
                    CGMIPS: 9.83,
                    T1: 9.93,
                    T2: 9.98,
                    T3: 11.9,
                    T4: 9.93,
                    T5: 10.32,
                    T6: 10.35,
                    T7: 7.63,
                    T8: 7.65,
                    T9: 10.26,
                    T10: 7.68,
                    T11: 7.52,
                    T12: 9.39,
                    T13: 1.70,
                    T14: 14.41,
                    T15: 9.57,
                    Pfannkuchen: 22.23,
                    Eratosthenes: 13.19,
                    Serestone: 952.7,
                    Romberg: 128.48,
                    Trapezoid: 197.39,
                    Mirestone: 28.08,
                    MCS: 64.16,
                    PI: 610.69,
                    SR2: 1180,
                },
                i3_8130U_R310_64: {
                    nqueensx: 11.55,
                    CGMIPS: 11.51,
                    T1: 11.53,
                    T2: 11.64,
                    T3: 13.71,
                    T4: 11.32,
                    T5: 12.11,
                    T6: 12.16,
                    T7: 9.00,
                    T8: 8.99,
                    T9: 11.78,
                    T10: 8.92,
                    T11: 8.78,
                    T12: 11.79,
                    T13: 16.14,
                    T14: 17.05,
                    T15: 11.14,
                    Pfannkuchen: 23.72,
                    Eratosthenes: 13.96,
                    Serestone: 975.38,
                    Romberg: 142,
                    Trapezoid: 212.97,
                    Mirestone: 30.19,
                    MCS: 56.93,
                    PI: 555.27,
                    SR2: 1232,
                },
                i7_8700_R310_64: {
                    nqueensx: 14.1,
                    CGMIPS: 14.23,
                    T1: 14.11,
                    T2: 14.14,
                    T3: 16.38,
                    T4: 14.21,
                    T5: 14.68,
                    T6: 14.76,
                    T7: 12.54,
                    T8: 11.04,
                    T9: 14.58,
                    T10: 12.32,
                    T11: 10.88,
                    T12: 14.19,
                    T13: 19.16,
                    T14: 20.21,
                    T15: 13.31,
                    Pfannkuchen: 32,
                    Eratosthenes: 19.78,
                    Serestone: 1366,
                    Romberg: 192.69,
                    Trapezoid: 296.07,
                    Mirestone: 40,
                    MCS: 44.94,
                    PI: 417.25,
                    SR2: 1701,
                },
                GHM_R310_64: {
                    nqueensx: 12.3,
                    CGMIPS: 11.83,
                    T1: 11.61,
                    T2: 11.61,
                    T3: 13.81,
                    T4: 11.59,
                    T5: 12.85,
                    T6: 12.95,
                    T7: 8.37,
                    T8: 8.52,
                    T9: 12.74,
                    T10: 9.2,
                    T11: 8.81,
                    T12: 11.4,
                    T13: 19.46,
                    T14: 18.65,
                    T15: 11.35,
                    Pfannkuchen: 25.4,
                    Eratosthenes: 15.48,
                    Serestone: 1108,
                    Romberg: 149.89,
                    Trapezoid: 238.08,
                    Mirestone: 33.33,
                    MCS: 58.83,
                    PI: 554.61,
                    SR2: 1170,
                },
                X2_240E_R310_64: {
                    nqueensx: 6.92,
                    CGMIPS: 7.32,
                    T1: 7.4,
                    T2: 7.49,
                    T3: 8.46,
                    T4: 7.27,
                    T5: 7.73,
                    T6: 7.95,
                    T7: 5.72,
                    T8: 5.83,
                    T9: 7.35,
                    T10: 5.67,
                    T11: 5.7,
                    T12: 6.94,
                    T13: 10.04,
                    T14: 11.01,
                    T15: 7.3,
                    Pfannkuchen: 15.82,
                    Eratosthenes: 9.13,
                    Serestone: 666.12,
                    Romberg: 94.68,
                    Trapezoid: 142,
                    Mirestone: 19.78,
                    MCS: 85.66,
                    PI: 851.9,
                    SR2: 838,
                },
                Thinkpad_R310_64: {
                    nqueensx: 9.63,
                    CGMIPS: 9.98,
                    T1: 10.08,
                    T2: 10.14,
                    T3: 12.08,
                    T4: 10.08,
                    T5: 10.46,
                    T6: 10.45,
                    T7: 7.75,
                    T8: 7.77,
                    T9: 10.44,
                    T10: 7.81,
                    T11: 7.67,
                    T12: 9.61,
                    T13: 13.91,
                    T14: 14.6,
                    T15: 9.72,
                    Pfannkuchen: 22.7,
                    Eratosthenes: 13.19,
                    Serestone: 952.7,
                    Romberg: 131.61,
                    Trapezoid: 197.39,
                    Mirestone: 27.36,
                    MCS: 62.94,
                    PI: 636.42,
                    SR2: 1151,
                },
            }; // XXX: Add new benchmark data above
            function getColorForSystem(systemName) {
                const hash = Array.from(systemName).reduce((hash, char) => hash + char.charCodeAt(0), 0);
                const g = 0.618033988749895;
                const h = (hash * g) % 1;
                return `hsl(${Math.round(h * 360)}, 50%, 50%)`;
            }
            let tableSortMIPS = { col: null, asc: true };
            let tableSortOther = { col: null, asc: true };
            const MIPS_benchmarks = [
                "nqueensx", "CGMIPS",
                "T1",  "T2",  "T3",  "T4",  "T5",
                "T6",  "T7",  "T8",  "T9",  "T10",
                "T11", "T12", "T13", "T14", "T15"
            ];
            document.addEventListener('DOMContentLoaded', function() {
                const systemSelectElement = document.getElementById('systemSelect');
                const instructionsDiv = document.getElementById('instructions');
                function maybeHideInstructions() {
                    if (systemSelectElement.selectedOptions && systemSelectElement.selectedOptions.length > 0) {
                        instructionsDiv.style.display = 'none';
                    }
                }
                systemSelectElement.addEventListener('change', maybeHideInstructions);
                maybeHideInstructions();
                const benchmarkSelectElement = document.getElementById('benchmarkSelect');
                if (!systemSelectElement || !benchmarkSelectElement) {
                    console.error('Select elements not found');
                    return;
                }
                const systemSelect = new Choices(systemSelectElement, { searchResultLimit: -1, removeItemButton: true });
                const benchmarkSelect = new Choices(benchmarkSelectElement, { searchResultLimit: -1, removeItemButton: true });
                const notesContainer = document.getElementById('notesContainer');
                systemSelect.passedElement.element.addEventListener('change', function() {
                    const selectedSystems = systemSelect.getValue(true);
                    notesContainer.innerHTML = '';
                    selectedSystems.forEach(system => {
                        if (systemNotes[system]) {
                            const noteElement = document.createElement('div');
                            noteElement.classList.add('system-note');
                            const colorDot = `<br><p><span class="color-dot note-dot" style="background-color: ${getColorForSystem(system)}"></span></p>`;
                            noteElement.innerHTML = `<p><table border=1 margin=0 width=100% bgcolor=#222><tr><td><font size=-1><table margin=4 border=0 width=100% bgcolor=#252525><tr><td width=10% style='text-align: right; vertical-align: top'>${colorDot}</td><td width=90% style='text-align: left; vertical-align: top'>${systemNotes[system]}</td></tr></table></font></td></tr></table></p>`;
                            notesContainer.appendChild(noteElement);
                        }
                    });
                    maybeHideInstructions();
                });
                benchmarkSelect.setChoiceByValue(['CGMIPS', 'nqueensx', 'MCS', 'PI']);
                let charts = [];
                let sortLowestToHighest = false;
                const sortBtn = document.getElementById('sortChartsBtn');
                if (sortBtn) {
                    sortBtn.addEventListener('click', function() {
                        sortLowestToHighest = !sortLowestToHighest;
                        sortBtn.textContent = sortLowestToHighest ? "Enabled" : "Disabled";
                        updateChart();
                    });
                }
                function updateChart() {
                    const selectedSystems = systemSelect.getValue(true);
                    const selectedBenchmarks = benchmarkSelect.getValue(true);
                    if (selectedSystems.length === 0 || selectedBenchmarks.length === 0) {
                        document.getElementById('chartsContainer').innerHTML = '';
                        charts = [];
                        updateTable();
                        return;
                    }
                    const unitGroups = {};
                    selectedBenchmarks.forEach(benchmark => {
                        const unit = benchmarks.find(b => b.name === benchmark).unit;
                        if (!unitGroups[unit]) {
                            unitGroups[unit] = [];
                        }
                        unitGroups[unit].push(benchmark);
                    });
                    const scaleType = document.querySelector('input[name="scale"]:checked').value;
                    document.getElementById('chartsContainer').innerHTML = '';
                    charts.forEach(chart => chart.destroy());
                    charts = [];
                    Object.entries(unitGroups).forEach(([unit, benchmarksInUnit]) => {
                        const table = document.createElement('table');
                        table.setAttribute('margin', '4');
                        table.setAttribute('border', '1');
                        table.setAttribute('width', '100%');
                        table.setAttribute('bgcolor', '#252525');
                        const tr = document.createElement('tr');
                        const td = document.createElement('td');
                        const wrapper = document.createElement('div');
                        wrapper.className = 'chart-wrapper';
                        const canvas = document.createElement('canvas');
                        wrapper.appendChild(canvas);
                        td.appendChild(wrapper);
                        tr.appendChild(td);
                        table.appendChild(tr);
                        document.getElementById('chartsContainer').appendChild(document.createElement('p'));
                        document.getElementById('chartsContainer').appendChild(table);
                        const ctx = canvas.getContext('2d');
                        let systemsForChart = selectedSystems.slice();
                        if (sortLowestToHighest) {
                            if (benchmarksInUnit.length === 1) {
                                const bench = benchmarksInUnit[0];
                                systemsForChart.sort((a, b) => {
                                    const va = benchmarkData[a]?.[bench];
                                    const vb = benchmarkData[b]?.[bench];
                                    if (va === undefined) return 1;
                                    if (vb === undefined) return -1;
                                    return va - vb;
                                });
                            } else {
                                systemsForChart.sort((a, b) => {
                                    const sumA = benchmarksInUnit.reduce((acc, bench) => acc + (benchmarkData[a]?.[bench] ?? 0), 0);
                                    const sumB = benchmarksInUnit.reduce((acc, bench) => acc + (benchmarkData[b]?.[bench] ?? 0), 0);
                                    return sumA - sumB;
                                });
                            }
                        }
                        const datasets = systemsForChart.map((system) => ({
                            label: system,
                            data: benchmarksInUnit.map(benchmark => {
                                const value = benchmarkData[system]?.[benchmark];
                                return value === 0.0 ? null : value;
                            }),
                            backgroundColor: getColorForSystem(system),
                            borderColor: getColorForSystem(system).replace('50%', '70%'),
                            borderWidth: 1
                        }));
                        const chart = new Chart(ctx, {
                            type: 'bar',
                            data: {
                                labels: benchmarksInUnit,
                                datasets: datasets
                            },
                            options: {
                                responsive: true,
                                animation: {
                                    duration: 300,
                                },
                                indexAxis: 'x',
                                maintainAspectRatio: false,
                                aspectRatio: 1.8,
                                scales: {
                                    y: {
                                        type: scaleType,
                                        beginAtZero: true,
                                        title: { display: true, text: `Performance (${unit})` },
                                        ticks: { color: '#ffffff' },
                                        grid: { color: '#cccccc' }
                                    },
                                    x: {
                                        title: { display: false, text: 'Benchmarks' },
                                        ticks: { color: '#ffffff' },
                                        grid: { color: '#cccccc' }
                                    }
                                },
                                plugins: {
                                    legend: { position: 'top', labels: { font: { size: 11 }, color: '#ffffff' } },
                                    title: { display: true, text: `Benchmark â€” ${unit}`, color: '#ffffff' },
                                    subtitle: {
                                        display: !!unitSubtitles[unit],
                                        text: unitSubtitles[unit] || '',
                                        color: '#cccccc',
                                        font: { size: 12, weight: 'normal', style: 'italic' }
                                    },
                                    tooltip: {
                                        callbacks: {
                                            title: function(context) {
                                                const benchmark = context[0].label;
                                                const desc = benchmarks.find(b => b.name === benchmark).description;
                                                return `${benchmark}: ${desc}`;
                                            },
                                            label: function(context) {
                                                const dataset = context.dataset;
                                                const value = context.parsed.y;
                                                const unit = benchmarks.find(b => b.name === context.label).unit;
                                                return `${dataset.label}: ${value} ${unit}`;
                                            }
                                        },
                                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                        titleColor: '#ffffff',
                                        bodyColor: '#ffffff'
                                    }
                                }
                            }
                        });
                        charts.push(chart);
                    });
                    updateTable();
                }
                function renderDynamicTable(selectedSystems, selectedBenchmarks) {
                    const tableContainer = document.getElementById('tableContainer');
                    if (!selectedSystems.length || !selectedBenchmarks.length) {
                        tableContainer.innerHTML = '';
                        return;
                    }
                    const selectedT = selectedBenchmarks.filter(b => MIPS_benchmarks.includes(b));
                    const selectedOther = selectedBenchmarks.filter(b => !MIPS_benchmarks.includes(b));
                    let html = '';
                    function buildTable(systems, benches, tableId, sortState) {
                        if (!benches.length) return '';
                        let html = `<table id="${tableId}" class="dynamicTable">`;
                        html += '<thead><tr>';
                        html += `<th class="sortable-th${(sortState.col === 0 ? ' sorted-' + (sortState.asc ? 'asc' : 'desc') : '')}" data-col="0"><b>System</b></th>`;
                        benches.forEach((bench, i) => {
                            html += `<th class="sortable-th${sortState.col === i + 1 ? ' sorted-' + (sortState.asc ? 'asc' : 'desc') : ''}" data-col="${i + 1}"><b>${bench}</b></th>`;
                        });
                        html += '</tr></thead>';
                        let rows = systems.map(sys => {
                            return [
                                `<span class="system-label"><span class="color-dot" style="background-color: ${getColorForSystem(sys)}"></span>${sys}</span>`,
                                ...benches.map(b => {
                                    let v = (benchmarkData[sys] && benchmarkData[sys][b] !== undefined) ? benchmarkData[sys][b] : '';
                                    if (v !== '' && !isNaN(v)) {
                                        v = (Math.round(parseFloat(v) * 100) / 100).toFixed(2);
                                        return v;
                                    }
                                    return '';
                                })
                            ];
                        });
                        if (sortState.col !== null) {
                            rows.sort((a, b) => {
                                let va = a[sortState.col], vb = b[sortState.col];
                                if (sortState.col === 0) {
                                    va = va.replace(/<[^>]*>/g, '');
                                    vb = vb.replace(/<[^>]*>/g, '');
                                    return sortState.asc ? va.localeCompare(vb) : vb.localeCompare(va);
                                }
                                if (!isNaN(va) && !isNaN(vb) && va !== '' && vb !== '') {
                                    va = parseFloat(va); vb = parseFloat(vb);
                                    return sortState.asc ? va - vb : vb - va;
                                } else {
                                    return sortState.asc ? ('' + va).localeCompare('' + vb) : ('' + vb).localeCompare('' + va);
                                }
                            });
                        }
                        html += '<tbody>';
                        rows.forEach(row => {
                            html += '<tr>' + row.map(cell => `<td><code>${cell}</code></td>`).join('') + '</tr>';
                        });
                        html += '</tbody></table>';
                        return html;
                    }
                    if (selectedT.length) {
                        html += `<p><div><font size=-1>MIPS Benchmarks:</font></div></p>`;
                        html += buildTable(selectedSystems, selectedT, "dynamicTableT", tableSortMIPS);
                    }
                    if (selectedOther.length) {
                        html += `<p><div style="margin-top:1.5eml"><font size=-1>Other Benchmarks:</font></div></p>`;
                        html += buildTable(selectedSystems, selectedOther, "dynamicTableOther", tableSortOther);
                    }
                    tableContainer.innerHTML = html;
                    document.querySelectorAll('#dynamicTableT th.sortable-th').forEach(th => {
                        th.onclick = function () {
                            let col = parseInt(this.getAttribute('data-col'), 10);
                            if (tableSortMIPS.col === col) tableSortMIPS.asc = !tableSortMIPS.asc;
                            else { tableSortMIPS.col = col; tableSortMIPS.asc = true; }
                            renderDynamicTable(selectedSystems, selectedBenchmarks);
                        }
                    });
                    document.querySelectorAll('#dynamicTableOther th.sortable-th').forEach(th => {
                        th.onclick = function () {
                            let col = parseInt(this.getAttribute('data-col'), 10);
                            if (tableSortOther.col === col) tableSortOther.asc = !tableSortOther.asc;
                            else { tableSortOther.col = col; tableSortOther.asc = true; }
                            renderDynamicTable(selectedSystems, selectedBenchmarks);
                        }
                    });
                }
                function updateTable() {
                    const selectedSystems = systemSelect.getValue(true);
                    const selectedBenchmarks = benchmarkSelect.getValue(true);
                    renderDynamicTable(selectedSystems, selectedBenchmarks);
                }
                systemSelectElement.addEventListener('change', updateChart);
                benchmarkSelectElement.addEventListener('change', updateChart);
                document.querySelectorAll('input[name="scale"]').forEach(radio => {
                radio.addEventListener('change', updateChart);
                });
                updateChart();
            });
        </script>
    </main>
    <footer>
        <table border=0 width=100%>
            <tr>
                <td style="vertical-align: middle; text-align: left; white-space: nowrap;">
                    <span>&nbsp;&nbsp;Copyright &copy; <span id="copyright-year"></span> <a href="https://dps8m.gitlab.io">The DPS8M Development Team</a></span>
                </td>
                <td style="vertical-align: middle; text-align: right; white-space: nowrap;">
                    <small>Version <code>2025.6.15.1</code></small>&nbsp;&nbsp;
                </td>
            </tr>
        </table>
    </footer>
    <script>
        document.getElementById('copyright-year').textContent = new Date().getFullYear();
    </script>
</body>
</html>
